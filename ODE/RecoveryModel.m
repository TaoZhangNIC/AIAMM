%% Author : TAO ZHANG  * zt1996nic@gmail.com *
% Created Time : 2023-05-11 08:58
% Last Revised : TAO ZHANG ,2023-07-01
% Remark : ODE of Recovery Model

function yprime = RecoveryModel(t, x, XI, System)

%     switch System
%         case {'Duffing', 'van der Pol'}
%             Theta = [1 x(1) x(2) x(1)^2 x(1)*x(2) x(2)^2 x(1)^3 x(1)^2*x(2) x(1)*x(2)^2 x(2)^3]';
%         case 'Mathieu'
%             Theta = [1 sin(2*t)*x(1) x(1) x(2) x(1)^2 x(1)*x(2) x(2)^2 x(1)^3 x(1)^2*x(2) ...
%                 x(1)*x(2)^2 x(2)^3]';
%         case {'Lorenz system', 'Rossler system', 'Mean field model',...
%                 'Moore-Spiegel system', 'Belousov-Zhabotinsky reaction'}
%             Theta = [1 x(1) x(2) x(3) x(1)^2 x(1)*x(2) x(1)*x(3) x(2)^2 x(2)*x(3) x(3)^2 x(1)^3 ...
%                 x(1)^2*x(2) x(1)^2*x(3) x(1)*x(2)^2 x(1)*x(2)*x(3) x(1)*x(3)^2 x(2)^3 ...
%                 x(3)*x(2)^2 x(2)*x(3)^2 x(3)^3]'; 
%          case '5D autonomous disc dynamo'
%             Theta = [1 x(1) x(2) x(3) x(4) x(5) x(1)^2 x(1)*x(2) x(1)*x(3) x(1)*x(4) x(1)*x(5) x(2)^2 ...
%                 x(2)*x(3) x(2)*x(4) x(2)*x(5) x(3)^2 x(3)*x(4) x(3)*x(5) x(4)^2 x(4)*x(5) x(5)^2 ...
%                 x(1)^3 x(1)^2*x(2) x(1)^2*x(3) x(1)^2*x(4) x(1)^2*x(5) x(1)*x(2)^2 x(1)*x(2)*x(3) ...
%                 x(1)*x(2)*x(4) x(1)*x(2)*x(5) x(1)*x(3)^2 x(1)*x(3)*x(4) x(1)*x(3)*x(5) x(1)*x(4)^2 ...
%                 x(1)*x(4)*x(5) x(1)*x(5)^2 x(2)^3 x(2)^2*x(3) x(2)^2*x(4) x(2)^2*x(5) x(2)*x(3)^2 ...
%                 x(2)*x(3)*x(4) x(2)*x(3)*x(5) x(2)*x(4)^2 x(2)*x(4)*x(5) x(2)*x(5)^2 x(3)^3 x(3)^2*x(4) ...
%                 x(3)^2*x(5) x(3)*x(4)^2 x(3)*x(4)*x(5) x(3)*x(5)^2 x(4)^3 x(4)^2*x(5) x(4)*x(5)^2 x(5)^3]';                 
%         otherwise
%             error('Invalid systemName');
%     end
%     
%     yprime = XI * Theta;
% end

% %% only sin(2*t)*x(1) in library     
%     switch System
%         case {'Duffing', 'van der Pol'}
%             Theta = [x(1) x(2) x(1)^2 x(1)*x(2) x(2)^2 x(1)^3 x(1)^2*x(2) x(1)*x(2)^2 x(2)^3]';
%         case 'Mathieu'
%             Theta = [sin(2*t)*x(1) x(1) x(2) x(1)^2 x(1)*x(2) x(2)^2 x(1)^3 x(1)^2*x(2) ...
%                 x(1)*x(2)^2 x(2)^3]';
%         case {'Lorenz system', 'Rossler system', 'Mean field model',...
%                 'Moore-Spiegel system', 'Belousov-Zhabotinsky reaction'}
%             Theta = [x(1) x(2) x(3) x(1)^2 x(1)*x(2) x(1)*x(3) x(2)^2 x(2)*x(3) x(3)^2 x(1)^3 ...
%                 x(1)^2*x(2) x(1)^2*x(3) x(1)*x(2)^2 x(1)*x(2)*x(3) x(1)*x(3)^2 x(2)^3 ...
%                 x(3)*x(2)^2 x(2)*x(3)^2 x(3)^3]'; 
%          case '5D autonomous disc dynamo'
%             Theta = [x(1) x(2) x(3) x(4) x(5) x(1)^2 x(1)*x(2) x(1)*x(3) x(1)*x(4) x(1)*x(5) x(2)^2 ...
%                 x(2)*x(3) x(2)*x(4) x(2)*x(5) x(3)^2 x(3)*x(4) x(3)*x(5) x(4)^2 x(4)*x(5) x(5)^2 ...
%                 x(1)^3 x(1)^2*x(2) x(1)^2*x(3) x(1)^2*x(4) x(1)^2*x(5) x(1)*x(2)^2 x(1)*x(2)*x(3) ...
%                 x(1)*x(2)*x(4) x(1)*x(2)*x(5) x(1)*x(3)^2 x(1)*x(3)*x(4) x(1)*x(3)*x(5) x(1)*x(4)^2 ...
%                 x(1)*x(4)*x(5) x(1)*x(5)^2 x(2)^3 x(2)^2*x(3) x(2)^2*x(4) x(2)^2*x(5) x(2)*x(3)^2 ...
%                 x(2)*x(3)*x(4) x(2)*x(3)*x(5) x(2)*x(4)^2 x(2)*x(4)*x(5) x(2)*x(5)^2 x(3)^3 x(3)^2*x(4) ...
%                 x(3)^2*x(5) x(3)*x(4)^2 x(3)*x(4)*x(5) x(3)*x(5)^2 x(4)^3 x(4)^2*x(5) x(4)*x(5)^2 x(5)^3]';                 
%         otherwise
%             error('Invalid systemName');
%     end
%     
%     yprime = XI * Theta;
% end

%% various sin cos in library 
    switch System
        case {'Duffing', 'van der Pol'}
            Theta = [x(1) x(2) x(1)^2 x(1)*x(2) x(2)^2 x(1)^3 x(1)^2*x(2) x(1)*x(2)^2 x(2)^3]';
        case 'Mathieu'
            Theta = [sin(2*t)*x(1) sin(2*t)*x(2) cos(2*t)*x(1) cos(2*t)*x(2) sin(t)*x(1) sin(t)*x(2)...
                cos(t)*x(1) cos(t)*x(2) x(1) x(2) x(1)^2 x(1)*x(2) x(2)^2 x(1)^3 x(1)^2*x(2) ...
                x(1)*x(2)^2 x(2)^3]';
        case {'Lorenz system', 'Rossler system', 'Mean field model',...
                'Moore-Spiegel system', 'Belousov-Zhabotinsky reaction'}
            Theta = [x(1) x(2) x(3) x(1)^2 x(1)*x(2) x(1)*x(3) x(2)^2 x(2)*x(3) x(3)^2 x(1)^3 ...
                x(1)^2*x(2) x(1)^2*x(3) x(1)*x(2)^2 x(1)*x(2)*x(3) x(1)*x(3)^2 x(2)^3 ...
                x(3)*x(2)^2 x(2)*x(3)^2 x(3)^3]'; 
         case '5D autonomous disc dynamo'
            Theta = [x(1) x(2) x(3) x(4) x(5) x(1)^2 x(1)*x(2) x(1)*x(3) x(1)*x(4) x(1)*x(5) x(2)^2 ...
                x(2)*x(3) x(2)*x(4) x(2)*x(5) x(3)^2 x(3)*x(4) x(3)*x(5) x(4)^2 x(4)*x(5) x(5)^2 ...
                x(1)^3 x(1)^2*x(2) x(1)^2*x(3) x(1)^2*x(4) x(1)^2*x(5) x(1)*x(2)^2 x(1)*x(2)*x(3) ...
                x(1)*x(2)*x(4) x(1)*x(2)*x(5) x(1)*x(3)^2 x(1)*x(3)*x(4) x(1)*x(3)*x(5) x(1)*x(4)^2 ...
                x(1)*x(4)*x(5) x(1)*x(5)^2 x(2)^3 x(2)^2*x(3) x(2)^2*x(4) x(2)^2*x(5) x(2)*x(3)^2 ...
                x(2)*x(3)*x(4) x(2)*x(3)*x(5) x(2)*x(4)^2 x(2)*x(4)*x(5) x(2)*x(5)^2 x(3)^3 x(3)^2*x(4) ...
                x(3)^2*x(5) x(3)*x(4)^2 x(3)*x(4)*x(5) x(3)*x(5)^2 x(4)^3 x(4)^2*x(5) x(4)*x(5)^2 x(5)^3]';                 
        otherwise
            error('Invalid systemName');
    end
    
    yprime = XI * Theta;
end